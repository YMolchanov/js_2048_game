const t=new class{constructor(t){this.size=4,this.score=0,this.status="idle",this.board=t||this.createEmptyBoard()}createEmptyBoard(){return Array.from({length:this.size},()=>Array(this.size).fill(0))}getState(){return this.board}getScore(){return this.score}getStatus(){return this.status}start(){this.board=this.createEmptyBoard(),this.score=0,this.status="playing",this.addRandomTile(),this.addRandomTile()}restart(){this.start()}addRandomTile(){let t=[];for(let e=0;e<this.size;e++)for(let s=0;s<this.size;s++)0===this.board[e][s]&&t.push([e,s]);if(0===t.length)return;let[e,s]=t[Math.floor(Math.random()*t.length)];this.board[e][s]=.1>Math.random()?4:2}moveLeft(){return this.move("left")}moveRight(){return this.move("right")}moveUp(){return this.move("up")}moveDown(){return this.move("down")}move(t){if("playing"!==this.status)return!1;let e=JSON.stringify(this.board),s=[...this.board],r=t=>t[0].map((e,s)=>t.map(t=>t[s])),i=t=>t.map(t=>t.reverse());"up"===t&&(s=r(s)),"down"===t&&(s=i(r(s))),"right"===t&&(s=i(s)),s=s.map(t=>this.mergeRow(t)),"up"===t&&(s=r(s)),"down"===t&&(s=r(i(s))),"right"===t&&(s=i(s));let o=JSON.stringify(s)!==e;return o&&(this.board=s,this.addRandomTile(),this.canMove()||(this.status="lose")),o}mergeRow(t){let e=t.filter(t=>0!==t),s=[],r=0;for(;r<e.length;)if(e[r]===e[r+1]){let t=2*e[r];s.push(t),this.score+=t,2048===t&&(this.status="win"),r+=2}else s.push(e[r]),r++;for(;s.length<this.size;)s.push(0);return s}canMove(){for(let t=0;t<this.size;t++)for(let e=0;e<this.size;e++){let s=this.board[t][e];if(0===s||t<this.size-1&&s===this.board[t+1][e]||e<this.size-1&&s===this.board[t][e+1])return!0}return!1}},e=document.querySelectorAll(".field-cell"),s=document.querySelector(".game-score"),r=document.querySelector(".button"),i=document.querySelector(".message-start"),o=document.querySelector(".message-win"),a=document.querySelector(".message-lose");function n(){let r=t.getState();e.forEach((t,e)=>{let s=r[Math.floor(e/4)][e%4];t.textContent=0===s?"":s,t.className="field-cell",s&&t.classList.add(`field-cell--${s}`)}),s.textContent=t.getScore(),o.classList.toggle("hidden","won"!==t.getStatus()),a.classList.toggle("hidden","lose"!==t.getStatus())}r.addEventListener("click",()=>{t.start(),n(),i.classList.add("hidden"),r.textContent="Restart",r.classList.remove("start"),r.classList.add("restart")}),document.addEventListener("keydown",e=>{if("playing"!==t.getStatus())return;let s=!1;"ArrowLeft"===e.key&&(s=t.moveLeft()),"ArrowRight"===e.key&&(s=t.moveRight()),"ArrowUp"===e.key&&(s=t.moveUp()),"ArrowDown"===e.key&&(s=t.moveDown()),s&&n()});
//# sourceMappingURL=index.71a02c65.js.map
